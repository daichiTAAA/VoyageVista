# 全体構想 - VoyageVista
&nbsp;
# 作成記録
---
* 作成日時 2024/3/3 野田大一郎
* 更新日時
&nbsp;
# 概要
---
* このドキュメントはVoyageVistaプロジェクトの全体構想資料である。
&nbsp;
# 対象読者
---
* このドキュメントはVoyageVistaプロジェクトの全体構想を確認したいエンジニア用である。
&nbsp;
# 目的
---
* VoyageVistaプロジェクトの全体構想を記載する。
&nbsp;

# 内容
---

# 背景
* 海外旅行に行く際に有名なところの情報しかわからない。マイナーな面白そうな情報を集めるのにどうしたらいいか分からない。おそらくその国の言語を使って調べれば情報は出てくるだろうが、言葉が分からないため調べられない。
* インバウンドの回復
* 大阪万博による日本の認知度向上

# 機能要件
* 日本人側が海外の人に来てもらいたい際にPRページを作成できる機能。
* ルート提案機能（スポットA →スポットBを地図で自動作成）
* 観光地ごとに自動リンク機能（ユーザーに負荷をかけない）
* 日本語で作成した情報を各国の言語に自動で翻訳する機能。日本語のままだと検索に引っかからないのでは？SEOを高めるため？
* 観光地ごとの平均滞在時間のお知らせ
* 飲食店の情報と連携（食べログとか？）
* カメラで読み取って画面にwiki的な情報を表示
* 各地の観光協会のHPをスクレーピングして、AIで自動でページを作成する機能。

# 基本設計
### アーキテクチャ
* モジュラーモノリス
  * マイクロサービスアーキテクチャだとネットワークを介してサービスを接続すると遅延や障害が発生しやすく、考慮すべきことが多く、構築に時間がかかるため、まずはモジュラーモノリスアーキテクチャにする。
  * モジュール間はFastAPIで繋ぐ
  * 複数のモジュールを1つのモノリスとしてデプロイするために、 エントリーポイントでは FastAPI.include_router() によって各モジュールの APIRouter を 1つのASGIアプリケーションに統合しdocker化する。
  * モジュールの中の各機能で共通するコードは共通パッケージ化して使用する
### 構想
* フロントエンド側で呼んで使用可能なAPIを作成する
* Kubernetesを用い高可用性、耐障害性、無停止更新を実現する。
* FastAPIを用い、APIのリファレンスをSwagger UIで確認できるようにする
* フロントエンドからデータベースへはAPI経由でアクセスするようにし、直接アクセスしない
### 要素技術
* データベースにはPostgreSQLを使用する
* 環境管理にはconda、バージョン管理にpoetryを使用する
* コンテナ化にdockerを使用する

# 詳細設計
## モジュール: 各地の観光協会のHPをスクレーピングして、AIで自動でページを作成するモジュール
### 内容
* 観光協会のホームページをスクレーピングする
* AIで記事にまとめる
### 懸念点
* インスタグラムなど写真で見れるものには勝てないのでは？
* 観光協会毎にホームページの構造が異なるためスクレーピングが難しい
* 不要な情報もスクレーピングしてしまうことと、AIのトークン制限が厳しいことによりトークンがオーバーしてAIに入力できない
### 解決策
* 観光協会のホームページから画像のURLとその画像が載っているHPアドレスと市区町村名のみスクレーピングする
* 日本地図にマッピングして表示する

## モジュール: 日本人側が海外の人に来てもらいたい際にPRページを作成するモジュール
### 懸念点
* インスタグラムなどにどう対抗するか？
### 解決策
* インスタグラムアカウントを作成し作成された記事を自動でポストする　→　問題が起きそうな気がするので一旦保留とする
* 深い文化的洞察やローカルな視点を提供することで、単なる写真共有以上の価値を提供する
* ユーザーエンゲージメントの促進: コンテンツ作成プロセスにおいてユーザーがより積極的に関与するように、インセンティブの提供やゲーミフィケーションを導入する。例えば、優れたフィードバックや貢献に対して認識や報酬を提供する。
### 必要な機能
* 認証機能
* 写真の投稿機能
* 文章の投稿機能
* 投稿の編集機能
* 投稿されたデータのWebページへの連携機能
* 投稿された文章をAIでマークダウンに変換し見やすくする機能
* 投稿された文章をAIで各国の言葉に翻訳する機能
* 投稿された文章や写真を基に文化的洞察やローカルな視点をAIにより補足する機能
* 実際の利用者や閲覧者からのフィードバック、いいね機能によりコンテンツ作成者のエンゲージメントを促進する機能
#### 認証機能
* シングルサインオン認証ができるようにする
#### 写真の投稿機能
* POSTで記事IDとユーザーIDと画像を受け取る
* ユーザーID/記事ID/画像名(ユーザーID_記事ID_ランダムな5桁の文字列)　のパスでローカルに画像を保存する
* 投稿画像テーブルの投稿日時、ユーザーID、記事ID、画像パス、論理削除列に項目を追加する
#### 文章の投稿機能
* 写真の投稿機能と同様。ただし、ファイル形式はtextで、テーブルは投稿文章テーブル。
#### 投稿の編集機能
* 投稿に関しRESTfullにする
* 投稿されたデータのWebページへの連携機能
* GETでユーザーIDと記事IDを用いて文章と写真を取得できるようにする
* 投稿された文章をAIでマークダウンに変換し見やすくする機能
* 投稿された文章をAIに入力し見やすいマークダウンに変換しデータベースに保存する
* 投稿された文章をAIで各国の言葉に翻訳する機能
* 投稿された文章をAIで英語、中国語(2種類)、韓国語に変換しデータベースに保存する
* 投稿された文章や写真を基に文化的洞察やローカルな視点をAIにより補足する機能
* 投稿された文章や写真をAIに入力し文化的洞察やローカルな視点を文章に補足する。
* ユーザーはその補足に対しコメントをし、問題なければ投稿する。
* 投稿、データベースへの保存、AIへの入力、ユーザーへの表示、投稿を繰り返す。
* 実際の利用者や閲覧者からのフィードバック、いいね機能によりコンテンツ作成者のエンゲージメントを促進する機能
* 実際の利用者や閲覧者が記事に対し、フィードバックやいいねを投稿できるようにする
